<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>web 性能测试</title>
    <link rel="stylesheet" href="./index.css" />
  </head>
  <body>
    <div class="title">Performance example</div>
    <div class="move-box">Move</div>
    <img
      class="img1"
      src="data:image/jpeg;base64,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"
      alt=""
    />
    <img class="img2" src="" alt="" />
    <img
      class="img3"
      src="https://img-qn.51miz.com/preview/element/00/01/31/40/P-1314051-90333C7B.png!/quality/90/unsharp/true/compress/true/format/png/fw/720"
      alt=""
    />
    <div id="container"></div>
    <script src="/wpDist/index.global.js"></script>
    <script>
      window.wv = new encodeMonitor.WebVitals({
        appId: 'encode-monitor',
        version: '1.0.0',
        reportCallback: (metrics) => {
          if (window.wv) {
            const infos = window.wv.getCurrentMetrics();

            const pageInfo = infos['page-information'];
            const networkInfo = infos['network-information'];
            const deviceInfo = infos['device-information'];

            function mergeData(data) {
              const {
                data: { name, ...metrics },
                ...rest
              } = data;
              if (name !== 'resource-flow' && name.indexOf('info') < 0) {
                return {
                  name,
                  ...metrics,
                  ...rest,
                  ...pageInfo.value,
                  ...networkInfo.value,
                  ...deviceInfo.value,
                };
              }
              return data;
            }
            console.log(mergeData(metrics));
          }
        },
        immediately: true,
        needCCP: true,
        logFpsCount: 10,
      });

      setTimeout(() => {
        document
          .querySelector('.img2')
          .setAttribute(
            'src',
            'https://img-qn.51miz.com/preview/element/00/01/31/40/P-1314051-90333C7B.png!/quality/90/unsharp/true/compress/true/format/png/fw/720',
          );
      }, 1000);

      wv.customContentfulPaint();

      function batchInsertNodeIntoContainer() {
        const count = 300;

        for (let i = 0; i < count; i++) {
          let node = document.createElement('div');
          node.innerHTML = '这是一个节点';
          node.style.width = '200px';
          node.style.height = '100px';
          document.querySelector('#container').append(node);
        }
      }

      wv.setStartMark('insertNode');
      batchInsertNodeIntoContainer();
      wv.setEndMark('insertNode');
    </script>
  </body>
</html>
